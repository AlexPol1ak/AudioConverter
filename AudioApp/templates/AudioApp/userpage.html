{% extends 'AudioApp/layout.html' %}
{% load static %}
{% load media as song %)

{% block content %}

<div class="features">
    <center>
        <h3>Ваши файлы: </h3><br>
<!--        Если у пользвователя еще нет аудио-->
        {% if 'Not_audio' in userdata %}
        <meta http-equiv="refresh" content="0;{% url 'error404' %}">
        {% else %}

        {% if userdata|length > 0 %}
<!--            Перебор списка с аудио-->
            {% for u in page_obj.object_list %}
                <details>
                    <summary><em>{{ forloop.counter}}.{{u.audiofile_name}}</em></summary>

                    <a href="{% url 'file_download' u.convert_aduio_relpath %}">
                        <em>
                            {{u.convert_audio_fullname}}
                        </em>
                    </a>&nbsp &nbsp -конвертирован ({{u.convert_size_mb}})Mb

                    <br>
                    <br>

                        <a href="{% url 'file_download' u.orig_aduio_relpath %}">
                            <em>
                            {{u.orig_audio_fullname}}
                            </em>
                        </a>&nbsp &nbsp -оригинал ({{u.orig_size_mb}})Mb

                    <br>

                    <form action="{% url 'audio_delete' %}" method="post">
                        {% csrf_token %}
                        <button name="audio_id" value="{{u.pk}}" type="submit" class="btn btn-danger">Удалить</button>
                    </form>

                </details>

                <br>

            {% endfor %}
<!--                Пагинация-->
                {% if page_obj.has_other_pages %}
                    <div class="">


                    {% if page_obj.has_previous %}
                        <a href="?page={{ page_obj.previous_page_number }}"><i> <<Предыдущая страница &nbsp &nbsp</i></a>
                    {% else %}
                        <i>Предыдущая страница &nbsp &nbsp</i>
                    {% endif %}

                    {% for p in paginator.page_range %}
		                {% if page_obj.number == p %}
                            {{p}}
                        {% elif p >= page_obj.number|add:-2 and p <= page_obj.number|add:2 %}
                            <a href="?page={{p}}"><i>{{ p }}</i></a>
                        {% endif %}
                    {% endfor %}

                    {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}"><i>&nbsp &nbsp >>Следующая страница</i></a>
                    {% else %}
                        <a><i>&nbsp &nbsp >>Следующая страница</i></a>
                    {% endif %}
                    </div>
                {% endif %}


        {% else %}
            <p>У Вас нет аудиофайлов.</p>
        {% endif %}

    {% endif %}
    </center>
</div>

{% endblock %}
